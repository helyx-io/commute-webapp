////////////////////////////////////////////////////////////////////////////////////
// Imports
////////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////////
// Routes
////////////////////////////////////////////////////////////////////////////////////

var express = require('express');
var moment = require('moment');

var logger = require('../log/logger');

var security = require('../lib/security');

var models = require('../models');
var Trip = models.Trip


////////////////////////////////////////////////////////////////////////////////////
// Routes
////////////////////////////////////////////////////////////////////////////////////

var router = express.Router();

router.get('/', /*security.ensureJWTAuthenticated,*/ (req, res) => {

  Trip.findAll({ limit: 1000 }).complete((err, trips) => {

    if (err) {
      res.json(500, { message: err.message });
    }
    else {
      trips = trips.map((trip) => { return trip.toJSON(); });
      res.json(trips);
    }
  });

});


router.get('/:tripId', /*security.ensureJWTAuthenticated,*/ (req, res) => {

  var tripId = req.params.tripId;

  Trip.find({ where:{ trip_id: tripId } }).complete((err, trip) => {

    if (err) {
      res.json(500, { message: err.message });
    }
    else {
      res.json(trip.toJSON());
    }
  });

});


////////////////////////////////////////////////////////////////////////////////////
// Exports
////////////////////////////////////////////////////////////////////////////////////

module.exports = router;
