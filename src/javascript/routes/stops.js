////////////////////////////////////////////////////////////////////////////////////
// Imports
////////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////////
// Routes
////////////////////////////////////////////////////////////////////////////////////

var express = require('express');
var moment = require('moment');

var logger = require('../log/logger');

var security = require('../lib/security');

var models = require('../models');
var Stop = models.Stop


////////////////////////////////////////////////////////////////////////////////////
// Routes
////////////////////////////////////////////////////////////////////////////////////

var router = express.Router();

router.get('/', /*security.ensureJWTAuthenticated,*/ (req, res) => {

  Stop.findAll({ limit: 1000 }).complete((err, stops) => {

    if (err) {
      res.json(500, { message: err.message });
    }
    else {
      stops = stops.map((stop) => { return stop.toJSON(); });
      res.json(stops);
    }
  });

});


router.get('/:stopId', /*security.ensureJWTAuthenticated,*/ (req, res) => {

  var stopId = req.params.stopId;

  Stop.find({ where:{ stop_id: stopId } }).complete((err, stop) => {

    if (err) {
      res.json(500, { message: err.message });
    }
    else {
      res.json(stop.toJSON());
    }
  });

});


////////////////////////////////////////////////////////////////////////////////////
// Exports
////////////////////////////////////////////////////////////////////////////////////

module.exports = router;
