////////////////////////////////////////////////////////////////////////////////////
// Imports
////////////////////////////////////////////////////////////////////////////////////

var passport = require('passport');


////////////////////////////////////////////////////////////////////////////////////
// Middlewares
////////////////////////////////////////////////////////////////////////////////////

var ensureAuthenticated = function(req, res, next) {
	if (req.isAuthenticated()) {
		return next();
	} else {
		res.redirect("/auth/login");
	}
};

var ensureJWTAuthenticated = function(req, res, next) {
	passport.authenticate(['oauth2-jwt-bearer'], { session: false })(req, res, next);
};


////////////////////////////////////////////////////////////////////////////////////
// Exports
////////////////////////////////////////////////////////////////////////////////////

module.exports = {
	ensureAuthenticated: ensureAuthenticated,
	ensureJWTAuthenticated: ensureJWTAuthenticated
};
